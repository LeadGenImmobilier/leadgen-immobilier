<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LeadGen Immobilier</title>

  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.35.0/dist/supabase.min.js" defer></script>

  <style>
    :root{
      --primary:#0b5ed7; 
      --white:#ffffff;
      --muted:#f4f6fb;
      --card-shadow: 0 6px 18px rgba(11,94,215,0.12);
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--muted),#fff);color:var(--primary);}
    header{background:var(--white);border-bottom:1px solid #e6eefb;padding:18px 24px;position:sticky;top:0;z-index:10}
    .nav{max-width:1100px;margin:0 auto;display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:46px;height:46px;border-radius:8px;background:linear-gradient(135deg,var(--primary),#3aa0ff);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:18px}
    nav a{margin:0 8px;color:var(--primary);text-decoration:none;font-weight:600}
    .hero{max-width:1100px;margin:28px auto;padding:28px;background:url('https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=1400&q=60') center/cover no-repeat;border-radius:12px;color:var(--white);display:flex;align-items:center;min-height:320px}
    .hero .content{backdrop-filter:blur(4px);background:rgba(0,0,0,0.25);padding:22px;border-radius:10px}
    .hero h1{font-size:32px;margin:0 0 8px}
    .hero p{margin:0 0 12px;opacity:0.95}
    .btn{background:var(--white);color:var(--primary);padding:10px 14px;border-radius:8px;border:none;font-weight:700;cursor:pointer}
    section{max-width:1100px;margin:28px auto;padding:0 16px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:18px}
    .card{background:var(--white);border-radius:12px;padding:12px;box-shadow:var(--card-shadow);}
    .card img{width:100%;height:160px;object-fit:cover;border-radius:8px}
    .meta{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
    .meta .name{font-weight:700}
    .meta .price{color:var(--primary);font-weight:800}
    footer{background:#072b5b;color:var(--white);padding:20px;margin-top:28px}
    footer a{color:var(--white);text-decoration:none}
    .admin-panel{position:fixed;right:18px;bottom:18px;background:var(--primary);color:var(--white);padding:12px;border-radius:12px;box-shadow:0 8px 20px rgba(11,94,215,0.18);z-index:30}
    .modal-backdrop{position:fixed;inset:0;background:rgba(4,10,30,0.45);display:none;align-items:center;justify-content:center;z-index:40}
    .modal{background:var(--white);padding:18px;border-radius:12px;min-width:320px;max-width:760px}
    label{display:block;margin:8px 0 6px;font-size:13px}
    input[type=text],input[type=number],input[type=password],textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eefb}
    .row{display:flex;gap:8px}
    .small{width:120px}
    .danger{background:#ff4d4f;color:white}
    .muted{color:#475569;font-size:13px}
    .topbar-controls{display:flex;gap:8px;align-items:center}
    @media (max-width:700px){.hero{min-height:220px}.hero h1{font-size:22px}}
  </style>
</head>

<body>

  <!-- Header -->
  <header>
    <div class="nav">
      <div class="brand">
        <div class="logo">LG</div>
        <div>
          <div style="font-weight:800;color:var(--primary)">LeadGen Immobilier</div>
          <div class="muted" style="font-size:13px">Real estate lead generation & property marketing</div>
        </div>
      </div>
      <div class="topbar-controls">
        <nav>
          <a href="#home">Home Page</a>
          <a href="#properties">Properties Available</a>
          <a href="#team">Our Team</a>
          <a href="#contact">Contact Us</a>
          <a href="#feedback">Feedback</a>
        </nav>
        <button class="btn" id="loginBtn">Admin</button>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section id="home" class="hero">
    <div class="content">
      <h1>We connect buyers with their dream properties — faster.</h1>
      <p>LeadGen Immobilier provides targeted leads, listing promotion and conversion funnels for apartments, villas, and high-end properties. We generate quality vetted leads so you focus on closing.</p>
      <div style="display:flex;gap:10px;margin-top:12px">
        <button class="btn" onclick="document.getElementById('properties').scrollIntoView({behavior:'smooth'})">See Properties</button>
        <button style="background:transparent;border:2px solid var(--white);color:var(--white);padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:700">Get a Quote</button>
      </div>
    </div>
  </section>

  <!-- Properties Section -->
  <section id="properties">
    <h2 style="color:var(--primary)">Properties Available</h2>
    <p class="muted">Browse our current listings. (If you're the admin, click the Admin button to add or remove properties.)</p>
    <div id="propsGrid" class="grid" style="margin-top:12px"></div>
  </section>

  <!-- Team Section -->
  <section id="team">
    <h2 style="color:var(--primary)">Our Team</h2>
    <div class="grid" style="margin-top:12px">
      <div class="card">
        <img src="https://images.unsplash.com/photo-1607746882042-944635dfe10e?auto=format&fit=crop&w=900&q=60" alt="team">
        <div style="margin-top:10px"><div class="name">Anas Azg</div><div class="muted">Founder & Head of Lead Strategy</div></div>
      </div>
      <div class="card">
        <img src="https://images.unsplash.com/photo-1542744173-8e7e53415bb0?auto=format&fit=crop&w=900&q=60" alt="team2">
        <div style="margin-top:10px"><div class="name">Marketing Team</div><div class="muted">Ad creatives, media buying & analytics</div></div>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact">
    <h2 style="color:var(--primary)">Contact Us</h2>
    <p class="muted">Reach out to LeadGen Immobilier</p>
    <div style="display:flex;gap:16px;flex-wrap:wrap;margin-top:12px">
      <div class="card" style="flex:1;min-width:260px">
        <h3 style="margin:0 0 8px">Direct</h3>
        <div class="muted">Phone: <a href="tel:+212600000000">+212 6 00 00 00 00</a></div>
        <div class="muted">WhatsApp: <a href="https://wa.me/212600000000" target="_blank">Chat on WhatsApp</a></div>
        <div class="muted">Email: <a href="mailto:contact@leadgen-immobilier.com">contact@leadgen-immobilier.com</a></div>
      </div>
      <div class="card" style="flex:1;min-width:260px">
        <h3 style="margin:0 0 8px">Social</h3>
        <div class="muted">Facebook: <a href="#" target="_blank">LeadGen Immobilier</a></div>
        <div class="muted">Instagram: <a href="#" target="_blank">@leadgen.immobilier</a></div>
        <div class="muted">YouTube: <a href="#" target="_blank">Channel</a></div>
      </div>
    </div>
  </section>

  <!-- Feedback Section -->
  <section id="feedback">
    <h2 style="color:var(--primary)">Feedback</h2>
    <p class="muted">Tell us how we did</p>
    <div class="card" style="margin-top:12px">
      <form id="feedbackForm">
        <label for="fbname">Your name</label>
        <input id="fbname" type="text" placeholder="Name">
        <label for="fbmsg">Message</label>
        <textarea id="fbmsg" rows="4" placeholder="Your feedback"></textarea>
        <div style="margin-top:10px"><button class="btn">Send Feedback</button></div>
      </form>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div style="max-width:1100px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
      <div>
        <div style="font-weight:800">LeadGen Immobilier</div>
        <div class="muted">Quality leads — premium properties</div>
      </div>
      <div style="display:flex;gap:12px;align-items:center">
        <a href="#">Facebook</a>
        <a href="#">Instagram</a>
        <a href="#">WhatsApp</a>
        <a href="tel:+212600000000">Call</a>
      </div>
    </div>
  </footer>

  <!-- Admin floating button -->
  <div class="admin-panel" id="adminPanel" style="display:none">
    <div style="font-weight:800">Admin</div>
    <div style="font-size:13px;opacity:0.95">Manage listings</div>
    <div style="margin-top:10px;display:flex;gap:8px">
      <button class="btn" id="openAdd">Add Property</button>
      <button class="btn" id="openManage">Manage</button>
    </div>
  </div>

  <!-- Modal backdrop -->
  <div class="modal-backdrop" id="modalWrap">
    <div class="modal" id="modalContent"></div>
  </div>

  <!-- Scripts -->
  <script>
    const SUPABASE_URL = 'sb_publishable_N8SmY7U4KDsqCtuoMIQ2fA_D6rNjL4N';
    const SUPABASE_ANON_KEY = 'sb_secret_1DLFRaoWrjz_IRNU1zKUWA_cwhJnEbX';
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const loginBtn = document.getElementById('loginBtn');
    const adminPanel = document.getElementById('adminPanel');
    const modalWrap = document.getElementById('modalWrap');
    const modalContent = document.getElementById('modalContent');
    const propsGrid = document.getElementById('propsGrid');

    // ----------------- Helper Functions -----------------
    function escapeHtml(str=''){return String(str).replace(/[&<>"]/g, s=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[s]))}
    function sanitize(url){ if(!url) return ''; return url.split(' ').join('%20'); }
    function formatPrice(v){ if(!v && v!==0) return '—'; return typeof v==='number'?v.toLocaleString('en-US',{style:'currency',currency:'USD'}):v }

    // ----------------- Properties -----------------
    async function loadProperties(){
      try{
        const { data: properties, error } = await supabase.from('properties').select('*').order('created_at',{ascending:false});
        if(error) return console.error(error);
        propsGrid.innerHTML='';
        if(properties.length===0) propsGrid.innerHTML='<div class="muted">No properties yet.</div>';
        properties.forEach(p=>{
          propsGrid.innerHTML+=`
            <div class="card">
              <img src="${sanitize(p.image_url)}" alt="${escapeHtml(p.title)}">
              <h3>${escapeHtml(p.title)}</h3>
              <p>${escapeHtml(p.characteristics)}</p>
              <p>Price: ${formatPrice(p.price)}</p>
              <p>Value: ${formatPrice(p.value)}</p>
            </div>
          `;
        });
      }catch(e){console.error(e);}
    }

    document.addEventListener('DOMContentLoaded', loadProperties);

    // ----------------- Admin Login -----------------
    loginBtn.addEventListener('click', async ()=>{
      const session = supabase.auth.getSession();
      if(session.data?.session){
        await supabase.auth.signOut();
        loginBtn.textContent='Admin';
        adminPanel.style.display='none';
        alert('Logged out');
        return;
      }
      modalContent.innerHTML=`
        <h3>Admin login</h3>
        <label>Email</label><input id="adminEmailModal" type="email" placeholder="Email">
        <label>Password</label><input id="adminPasswordModal" type="password" placeholder="Password">
        <div style="margin-top:10px;text-align:right"><button class="btn" onclick="adminLoginModal()">Login</button></div>
      `;
      modalWrap.style.display='flex';
    });

    async function adminLoginModal(){
      const email = document.getElementById('adminEmailModal').value;
      const password = document.getElementById('adminPasswordModal').value;
      const { data, error } = await supabase.auth.signInWithPassword({ email, password });
      if(error) return alert('Login failed: '+error.message);
      alert('Logged in!');
      modalWrap.style.display='none';
      loginBtn.textContent='Logout';
      adminPanel.style.display='block';
      loadProperties();
    }

    modalWrap.addEventListener('click', e=>{ if(e.target===modalWrap) modalWrap.style.display='none'; });

  </script>

</body>
</html>
